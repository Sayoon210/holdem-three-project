# 씬 계층 구조화 및 성능 최적화 요약 보고서 (2026-02-18) 🏛️

본 문서는 파편화되어 있던 3D 오브젝트들을 유니티 스타일의 계층(Hierarchy) 구조로 재편하고, 물리 시스템 및 인터렉션 로직을 안정화한 작업 내용을 정리한 것입니다.

## 1. 계층 구조 재설계 (Hierarchy Restructuring)

기존의 모든 오브젝트가 World 0점을 기준으로 흩어져 있던 방식을 버리고, 논리적인 단위(Unit)로 그룹화했습니다.

### 🏛️ TableUnit (테이블 유닛)
- **위치**: `world z = -3`
- **관리 대상**:
  - `Table3D`: 테이블 메쉬 및 커뮤니티 슬롯
  - `CommunityBoard3D`: 보드에 깔리는 실제 카드들
  - `spotLight`: 테이블을 집중 조명하는 조명
  - `CardDeck3D`: 카드 덱 메쉬 (World `z = -1.0`을 유지하기 위해 로컬 `z = 2.0`으로 배치)
- **이점**: 테이블 위치 변경 시 조명과 보드 카드가 한 번에 따라 움직임.

### 👤 PlayerUnit (플레이어 유닛)
- **위치**: `world z = 3.5`
- **관리 대상**:
  - `InteractiveHand3D`: 플레이어의 손패
  - **Chip Tray**: 플레이어의 보유 칩 보관함
- **이점**: 플레이어의 시점이나 좌석 위치 변경에 유연하게 대응 가능.

---

## 2. 물리 시스템 및 인터렉션 안정화

### ⚖️ 물리 월드 통합 (Unified Physics)
- **수정 내용**: 각 그룹마다 별도의 `<Physics>` 태그를 사용하던 방식을 버리고, 전체 씬을 하나의 `<Physics>` 컨텍스트로 통합했습니다.
- **효과**: 카드가 테이블을 뚫고 내려가는 현상을 완벽히 방지하고, 모든 사물 간의 물리 상호작용이 정상화되었습니다.
- **바닥(Floor) 확장**: 맵 전체를 커버하는 거대 물리 바닥을 배치하여 안정성을 높였습니다.

### 🛰️ 좌표계 변환 및 애니메이션 정렬
- **마우스 드래그**: `worldToLocal()`을 사용하여 부모 그룹이 어디에 있든 마우스 포인터에 정확히 반응하도록 수정했습니다.
- **카드 애니메이션 (Deck Origin)**: 카드가 덱 메쉬 위치에서 정교하게 날아오도록 로컬 오프셋 계산식을 보정했습니다.

---

## 3. 유지보수성 향상

- **하드코딩 제거**: `-3`, `3.5` 등 주요 지점을 부모 그룹의 좌표로 캡슐화했습니다.
- **직관적 로컬 좌표**: 테이블 위 물건 배치 시 복잡한 계산 없이 `0`점을 기준으로 작업 가능합니다.

이제 전체적인 구조가 훨씬 견고해졌으며, 향후 기능 확장이나 시점 변경 시 매우 간편하게 대응할 수 있습니다! 🎰✨🚀
